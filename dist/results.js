import{getJson as t,getLanguage as e,Canvas as s,matchAxisTier as n,orderScores as o}from"./common.js";const l=new URLSearchParams(document.location.search);let i=l.get("lang")??"en";const a=e(i);i=a.lang??i;const c=(l.get("score")??"50,50,50,50,50,50").split(",").map((t=>{const e=parseFloat(t);return Number.isNaN(e)||!Number.isFinite(e)?50:Math.max(Math.min(e,100),0)}));if(c.length<6)throw alert("Invalid result"),new Error("Missing scores");l.get("send");const r=document.getElementById("results1"),d=document.getElementById("results2"),h=window.matchMedia?.("(prefers-color-scheme: dark)").matches,[m,x]=h?["#202020","#fff"]:["#e0e0e0","#000"],u=new s(r,800,880,"textfont",x,m),g=new class{canvas;ctx;font;bgColor;fgColor;images=["econ","stat","cult"];constructor(t,e,s,n,o,l){this.canvas=t,this.canvas.width=e,this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.font=n,this.fgColor=o,this.bgColor=l,this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,e,s)}drawImages(){this.images.forEach(((t,e)=>{const s=new Image;s.src="./assets/"+t+"compass.svg",s.addEventListener("load",(()=>this.ctx.drawImage(s,250*(e+1&2),500*(e+1&1),500,500)))}))}setFontsize(t){this.ctx.font=t.toFixed(0)+"px "+this.font}drawBorders(){this.ctx.fillStyle="black";for(let t=0;t<3;t++)this.ctx.fillRect(0,496*t,1e3,8),this.ctx.fillRect(496*t,0,8,1e3)}drawheader(t,e){this.ctx.fillStyle=this.fgColor,this.ctx.font="64px titlefont",this.ctx.fillText(t,16,64,480),this.setFontsize(32);for(let t=0;t<3;t++){const s=`${t+1}. ${e[t].name}`;this.ctx.fillText(s,16,112+40*t)}}drawAxis(t,e,s,n){this.ctx.fillStyle=this.fgColor,this.setFontsize(24);let o="";o+=e>=50?e.toFixed(1)+" "+s.leftvalue.name:(100-e).toFixed(1)+" "+s.rightvalue.name,o+=` (${n})`,this.ctx.fillText(o,16,240+48*t)}drawDot(t,e,s){e=4.64*(100-e)+18,s=4.64*(100-s)+18,e+=250*(2&t),s+=500*(1&t),this.ctx.fillStyle="white",this.ctx.lineWidth=4,this.ctx.beginPath(),this.ctx.arc(e,s,12,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}}(d,1e3,1e3,"textfont",x,m);g.drawImages();const f=a.resultstext.version_name+": "+window.VERSION,w=t("ideologies-"+i),p=o(c,[1,.9,1,.6,.6,.7],w);for(const t of Object.keys(a.resultstext.text))document.getElementById(t).textContent=a.resultstext.text[t];document.title=a.resultstext.text.title;document.getElementById("score1").textContent=`${a.resultstext.closest_match}: ${p[0].name}`;const v=document.getElementById("score2");v.textContent=a.resultstext.next_matches+": ";let y=Array();for(let t=1;t<5;t++)y.push(p[t].name);v.textContent+=y.join(", ");document.getElementById("desc").textContent=p[0].desc;document.getElementById("back_button").addEventListener("click",(()=>window.location.href="index.html?lang="+i));document.getElementById("full_list").addEventListener("click",(()=>window.location.href="lister.html?lang="+i+"&score="+c.map((t=>t.toFixed(1))).join(",")));for(let t=1;t<3;t++){document.getElementById("download"+t.toFixed()).addEventListener("click",(()=>{const e=document.createElement("a");e.download="dv.png";const s=document.getElementById("results"+t.toFixed());e.href=s.toDataURL("image/png"),e.click()}))}const E=document.getElementById("axisholder");let C=Array();a.axes.forEach(((t,e)=>{const s=n(c[e],t.tiers);let o;o=a.resultstext.axis_name_before?`${a.resultstext.axis_name} ${t.axisname}: ${s}`:`${t.axisname} ${a.resultstext.axis_name}: ${s}`,C.push(o);const l=document.createElement("h2");l.textContent=o,E.appendChild(l);const i=document.createElement("div");i.className="axis";const r=new Image;r.src=t.leftvalue.icon;const d=new Image;d.src=t.rightvalue.icon;const h=(t,e,s)=>{const n=document.createElement("div");if(n.className="bar",n.style.backgroundColor=e,n.style.width=s.toFixed(1)+"%",t?(n.style.borderLeftStyle="solid",n.style.textAlign="right"):(n.style.borderRightStyle="solid",n.style.textAlign="left"),s>20){const t=document.createElement("div");t.className="text-wrapper",t.textContent=s.toFixed(1)+"%",n.appendChild(t)}return n};i.appendChild(r),i.appendChild(h(!1,t.leftvalue.color,c[e])),i.appendChild(h(!0,t.rightvalue.color,100-c[e])),i.appendChild(d),E.appendChild(i)})),window.onload=()=>{u.drawHeader(a.resultstext.text.title,"quark88.github.io/dozenvalues/",f,p[0].name),g.drawBorders(),g.drawheader(a.resultstext.text.title,p),a.axes.forEach(((t,e)=>{if(g.drawAxis(e,c[e],a.axes[e],C[e].split(": ")[1]),e%2==0){const t=Math.floor(e/2)+1,[s,n]=2===t?[c[e+1],c[e]]:[c[e],c[e+1]];g.drawDot(t,s,n)}const s=[t.leftvalue.icon,t.rightvalue.icon];u.drawImages(s,e);const n=[t.leftvalue.color,t.rightvalue.color];u.drawBar(e,n,c[e],C[e])}))};
//# sourceMappingURL=results.js.map