import{getJson as t,getLanguage as e,Canvas as s,matchAxisTier as o,orderScores as n}from"./common.js";const l=new URLSearchParams(document.location.search);let a=l.get("lang")??"en";const i=e(a);a=i.lang??a;const c=(l.get("score")??"50,50,50,50,50,50").split(",").map((t=>parseFloat(t))),r=(l.get("send"),document.getElementById("results1")),d=document.getElementById("results2"),h=window.matchMedia?.("(prefers-color-scheme: dark)").matches,[x,m]=h?["#202020","#fff"]:["#e0e0e0","#000"],f=new s(r,800,880,"textfont",m,x),g=new class{canvas;ctx;font;bgColor;fgColor;images=["econ","stat","cult"];constructor(t,e,s,o,n,l){this.canvas=t,this.canvas.width=e,this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.font=o,this.fgColor=n,this.bgColor=l,this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,e,s)}drawImages(){this.images.forEach(((t,e)=>{const s=new Image;s.src="./assets/"+t+"compass.svg",s.addEventListener("load",(()=>this.ctx.drawImage(s,250*(e+1&2),500*(e+1&1),500,500)))}))}setFontsize(t){this.ctx.font=t.toFixed(0)+"px "+this.font}drawBorders(){this.ctx.fillStyle="black";for(let t=0;t<3;t++)this.ctx.fillRect(0,496*t,1e3,8),this.ctx.fillRect(496*t,0,8,1e3)}drawheader(t,e){this.ctx.fillStyle=this.fgColor,this.ctx.font="64px titlefont",this.ctx.fillText(t,16,64,480),this.setFontsize(32);for(let t=0;t<3;t++){const s=`${t+1}. ${e[t].name}`;this.ctx.fillText(s,16,112+40*t)}}drawAxis(t,e,s,o){this.ctx.fillStyle=this.fgColor,this.setFontsize(24);let n="";n+=e>=50?e.toFixed(1)+" "+s.leftvalue.name:(100-e).toFixed(1)+" "+s.rightvalue.name,n+=` (${o})`,this.ctx.fillText(n,16,240+48*t)}drawDot(t,e,s){e=4.64*(100-e)+18,s=4.64*(100-s)+18,e+=250*(2&t),s+=500*(1&t),this.ctx.fillStyle="white",this.ctx.lineWidth=4,this.ctx.beginPath(),this.ctx.arc(e,s,12,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}}(d,1e3,1e3,"textfont",m,x);g.drawImages();const u=i.resultstext.version_name+": "+window.VERSION,w=t("ideologies-"+a),p=n(c,[1,.9,1,.6,.6,.7],w);for(const t of Object.keys(i.resultstext.text))document.getElementById(t).textContent=i.resultstext.text[t];document.title=i.resultstext.text.title;document.getElementById("score1").textContent=`${i.resultstext.closest_match}: ${p[0].name}`;const y=document.getElementById("score2");y.textContent=i.resultstext.next_matches+": ";let v=Array();for(let t=1;t<5;t++)v.push(p[t].name);y.textContent+=v.join(", ");document.getElementById("desc").textContent=p[0].desc;document.getElementById("back_button").addEventListener("click",(()=>window.location.href="index.html?lang="+a));document.getElementById("full_list").addEventListener("click",(()=>window.location.href="lister.html?lang="+a+"&score="+c.map((t=>t.toFixed(1))).join(",")));for(let t=1;t<3;t++){document.getElementById("download"+t.toFixed()).addEventListener("click",(()=>{const e=document.createElement("a");e.download="dv.png";const s=document.getElementById("results"+t.toFixed());e.href=s.toDataURL("image/png"),e.click()}))}const E=document.getElementById("axisholder");let C=Array();i.axes.forEach(((t,e)=>{const s=o(c[e],t.tiers);let n;n=i.resultstext.axis_name_before?`${i.resultstext.axis_name} ${t.axisname}: ${s}`:`${t.axisname} ${i.resultstext.axis_name}: ${s}`,C.push(n);const l=document.createElement("h2");l.textContent=n,E.appendChild(l);const a=document.createElement("div");a.className="axis";const r=new Image;r.src=t.leftvalue.icon;const d=new Image;d.src=t.rightvalue.icon;const h=(t,e,s)=>{const o=document.createElement("div");if(o.className="bar",o.style.backgroundColor=e,o.style.width=s.toFixed(1)+"%",t?(o.style.borderLeftStyle="solid",o.style.textAlign="right"):(o.style.borderRightStyle="solid",o.style.textAlign="left"),s>20){const t=document.createElement("div");t.className="text-wrapper",t.textContent=s.toFixed(1)+"%",o.appendChild(t)}return o};a.appendChild(r),a.appendChild(h(!1,t.leftvalue.color,c[e])),a.appendChild(h(!0,t.rightvalue.color,100-c[e])),a.appendChild(d),E.appendChild(a)})),window.onload=()=>{f.drawHeader(i.resultstext.text.title,"quark88.github.io/dozenvalues/",u,p[0].name),g.drawBorders(),g.drawheader(i.resultstext.text.title,p),i.axes.forEach(((t,e)=>{if(g.drawAxis(e,c[e],i.axes[e],C[e].split(": ")[1]),e%2==0){const t=Math.floor(e/2)+1,[s,o]=2===t?[c[e+1],c[e]]:[c[e],c[e+1]];g.drawDot(t,s,o)}const s=[t.leftvalue.icon,t.rightvalue.icon];f.drawImages(s,e);const o=[t.leftvalue.color,t.rightvalue.color];f.drawBar(e,o,c[e],C[e])}))};
//# sourceMappingURL=results.js.map